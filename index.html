<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock Download Link</title>
    <style>
        body {
            background-color: #1e1e1e;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
        }
        .modal {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            width: 300px;
        }
        button, input {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            border: none;
        }
        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #download-link {
            display: none;
            margin-top: 20px;
        }
        .admin-section {
            display: none;
        }
        .link-list {
            margin-top: 10px;
            text-align: left;
        }
        .link-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .link-item button {
            background-color: #28a745;
        }
    </style>
</head>
<body>

    <!-- Halaman Admin Login -->
    <div class="modal" id="admin-login" style="display: none;">
        <h2>Admin Login</h2>
        <p>Masukkan password admin:</p>
        <input type="password" id="passwordInput" placeholder="Enter password">
        <button onclick="checkPassword()">Submit</button>
        <p id="message" style="color: red;"></p>
    </div>

    <!-- Halaman Admin Panel -->
    <div class="modal admin-section" id="admin-panel">
        <h2>Admin Panel</h2>
        <p>Masukkan link Telegram dan link download:</p>
        <input type="text" id="telegramLink" placeholder="Masukkan link Telegram">
        <input type="text" id="downloadLink" placeholder="Masukkan link Download">
        <button onclick="saveLinks()">Simpan</button>
        <button onclick="logoutAdmin()">Logout</button>

        <!-- Menampilkan link yang disimpan -->
        <div class="link-list" id="link-history"></div>
    </div>

    <!-- Halaman Pengguna -->
    <div class="modal" id="user-page">
        <h2 id="unlock-text">Unlock Download Link</h2>
        <p>Join Telegram untuk mengakses link download.</p>
        <button id="joinTelegram">Join Telegram</button>
        <div id="download-link">
            <p>Setelah join, download di sini:</p>
            <a href="#" id="downloadHref" target="_blank">Download Link</a>
        </div>
    </div>

    <script>
        let clickCount = 0; // Counter untuk menghitung klik

        // Password untuk admin
        const correctPassword = 'admin123'; // Ganti password di sini

        // Mengecek password admin
        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === correctPassword) {
                document.getElementById('admin-login').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                loadLinks(); // Load link dari localStorage
            } else {
                document.getElementById('message').textContent = 'Password salah. Coba lagi!';
            }
        }

        // Simpan link Telegram dan Download
        function saveLinks() {
            const telegramLink = document.getElementById('telegramLink').value;
            const downloadLink = document.getElementById('downloadLink').value;

            if (telegramLink && downloadLink) {
                // Ambil array link yang ada di localStorage
                const telegramLinks = JSON.parse(localStorage.getItem('telegramLinks')) || [];
                const downloadLinks = JSON.parse(localStorage.getItem('downloadLinks')) || [];

                // Tambahkan link baru ke array
                telegramLinks.push(telegramLink + '-updated');
                downloadLinks.push(downloadLink + '-new');

                // Simpan kembali ke localStorage
                localStorage.setItem('telegramLinks', JSON.stringify(telegramLinks));
                localStorage.setItem('downloadLinks', JSON.stringify(downloadLinks));

                // Tampilkan semua link di halaman admin
                displayLinks();

                // Reset input fields
                document.getElementById('telegramLink').value = '';
                document.getElementById('downloadLink').value = '';

                alert('Link berhasil disimpan!');
            } else {
                alert('Masukkan kedua link!');
            }
        }

        // Tampilkan link yang disimpan di halaman admin
        function displayLinks() {
            const telegramLinks = JSON.parse(localStorage.getItem('telegramLinks')) || [];
            const downloadLinks = JSON.parse(localStorage.getItem('downloadLinks')) || [];
            const linkHistory = document.getElementById('link-history');
            linkHistory.innerHTML = ''; // Kosongkan daftar link sebelumnya

            telegramLinks.forEach((link, index) => {
                const telegramItem = document.createElement('div');
                telegramItem.classList.add('link-item');
                telegramItem.innerHTML = `
                    <span>${link}</span>
                    <button onclick="copyLink('${link}')">Salin</button>
                `;
                linkHistory.appendChild(telegramItem);
            });

            downloadLinks.forEach((link, index) => {
                const downloadItem = document.createElement('div');
                downloadItem.classList.add('link-item');
                downloadItem.innerHTML = `
                    <span>${link}</span>
                    <button onclick="copyLink('${link}')">Salin</button>
                `;
                linkHistory.appendChild(downloadItem);
            });
        }

        // Salin link ke clipboard
        function copyLink(link) {
            navigator.clipboard.writeText(link).then(() => {
                alert('Link telah disalin ke clipboard!');
            }, (err) => {
                alert('Gagal menyalin link: ', err);
            });
        }

        // Load link dari localStorage ke form admin
        function loadLinks() {
            displayLinks();
        }

        // Logout admin
        function logoutAdmin() {
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('user-page').style.display = 'block';
        }

        // Mode Pengguna: Tampilkan link download setelah klik Join Telegram
        document.getElementById('joinTelegram').addEventListener('click', function() {
            const telegramLinks = JSON.parse(localStorage.getItem('telegramLinks')) || [];
            const downloadLinks = JSON.parse(localStorage.getItem('downloadLinks')) || [];

            if (telegramLinks.length === 0 || downloadLinks.length === 0) {
                alert('Link belum diset oleh admin.');
                return;
            }

            // Arahkan ke link Telegram terbaru
            window.open(telegramLinks[telegramLinks.length - 1], '_blank'); // Menggunakan link terbaru

            // Tampilkan link download terbaru
            const downloadHref = document.getElementById('downloadHref');
            downloadHref.href = downloadLinks[downloadLinks.length - 1]; // Menggunakan link terbaru
            document.getElementById('download-link').style.display = 'block';
        });

        // Tampilkan form admin setelah klik 8 kali pada teks 'Unlock Download Link'
        document.getElementById('unlock-text').addEventListener('click', function() {
            clickCount++;
            if (clickCount === 8) {
                document.getElementById('admin-login').style.display = 'block';
            }
        });

        // Menampilkan halaman pengguna jika admin tidak login
        window.onload = function() {
            document.getElementById('user-page').style.display = 'block';
        };
    </script>

</body>
</html>
